<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Розплутувач тривожного клубка</title>

  <meta name="description" content="Інструмент для розплутування тривожних думок. Визнач, що тебе турбує, з’ясуй причини та отримай поради." />
  <meta name="robots" content="index, follow" />
  <meta property="og:title" content="Розплутувач тривожного клубка" />
  <meta property="og:description" content="Інструмент для розплутування тривожних думок. Визнач, що тебе турбує, з’ясуй причини та отримай поради." />
  <meta property="og:type" content="website" />
  <link rel="icon" href="images/favicon-v2.png" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --primary-color:#4b0082;
      --secondary-color:#800080;
      --button-bg:#4c1d95;
      --button-hover:#5b21b6;
      --gray-50:#f9fafb;
      --white:#ffffff;
      --text:#111;
      --link-hover:#FFD700;
      --lang-toggle-bg:#ffffff;
      --lang-toggle-text:#000000;
      --lang-toggle-border:#ff0000;
    }
    *,*::before,*::after{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0; padding:0; line-height:1.6; color:var(--text); background:var(--white);
      font-family:'Lora',serif; display:flex; flex-direction:column;
    }

    /* Utils */
    .container{ max-width:1200px; margin:0 auto; padding:0 1rem; }
    .page-wrap{ flex:1; }
    .text-center{ text-align:center; }
    .text-left{ text-align:left; }
    .py-20{ padding:5rem 0; } .py-16{ padding:4rem 0; }
    .mb-4{ margin-bottom:1rem; } .mb-6{ margin-bottom:1.5rem; }
    .mt-4{ margin-top:1rem; } .mt-6{ margin-top:1.5rem; } .mt-8{ margin-top:2rem; }
    .text-5xl{ font-size:3rem; } .text-3xl{ font-size:1.875rem; } .text-2xl{ font-size:1.5rem; } .text-xl{ font-size:1.25rem; } .text-lg{ font-size:1.125rem; }
    .font-bold{ font-weight:700; } .font-semibold{ font-weight:600; } .font-lora{ font-family:'Lora',serif; }
    .bg-gray-50{ background-color:var(--gray-50); }
    .bg-gradient-to-r{ background:linear-gradient(to right,var(--primary-color),var(--secondary-color)); }

    /* Nav */
    nav{
      background:linear-gradient(to right,var(--primary-color),var(--secondary-color));
      color:#fff; position:sticky; top:0; z-index:10;
    }
    nav .container{ display:flex; align-items:center; justify-content:space-between; padding:1rem 1rem; }
    .logo-link{ display:flex; align-items:center; gap:0.5rem; color:#fff; text-decoration:none; font-weight:700; font-size:1.5rem; }
    .logo-img{ width:32px; height:32px; }

    .menu-toggle{ display:none; font-size:1.5rem; background:none; border:none; color:#fff; cursor:pointer; }

    #primary-nav{ list-style:none; display:flex; gap:1rem; margin:0; padding:0; }
    #primary-nav a{
      color:#fff; text-decoration:none; padding:0.5rem; display:block; font-size:0.9375rem;
      transition:transform .2s ease,color .2s ease;
    }
    #primary-nav a:hover,#primary-nav a:focus{ color:var(--link-hover); transform:scale(1.03); }
    #primary-nav a.active,#primary-nav a[aria-current="page"]{ color:var(--link-hover); text-decoration:underline; }

    .lang-toggle{
      cursor:pointer; font-weight:700; color:var(--lang-toggle-text);
      background:var(--lang-toggle-bg); border:2px solid var(--lang-toggle-border);
      padding:0.5rem 1rem; border-radius:9999px; font-size:1.125rem;
      transition:background-color .3s ease, transform .2s ease; margin-left:1rem;
    }
    .lang-toggle:hover,.lang-toggle:focus{ background:#e0e0e0; transform:scale(1.05); }

    .lang-section{ display:none; }
    .lang-section.active{ display:inline; }

    /* Hero */
    .hero h1{ color:#fff; text-shadow:0 2px 4px rgba(0,0,0,.3); }
    .hero .subtitle{ color:#fff; text-shadow:0 1px 2px rgba(0,0,0,.25); }

    /* Stages form */
    .stage{
      background:#fff; padding:1.8rem; margin-bottom:1.5rem; border-radius:12px;
      box-shadow:0 4px 12px rgba(0,0,0,.08); position:relative; overflow:hidden;
    }
    .stage::before{
      content:''; position:absolute; left:0; top:0; width:4px; height:100%; background:var(--secondary-color);
    }
    .stage h2{ color:var(--primary-color); font-size:1.4rem; margin:0 0 1rem 0; font-weight:600; }

    label{ display:block; font-weight:600; margin:.6rem 0; color:#333; }

    input[type="text"], textarea, select{
      width:100%; padding:.7rem; border:1px solid #d1d5db; border-radius:6px; font-size:1rem; background:#f9fafb; transition:border-color .2s ease;
    }
    input[type="text"]:focus, textarea:focus, select:focus{ outline:none; border-color:var(--primary-color); }
    textarea{ resize:vertical; min-height:90px; }

    .slider-container{ display:flex; align-items:center; gap:1rem; margin:.5rem 0 1rem; }
    input[type="range"]{ flex:1; accent-color:var(--secondary-color); }
    .slider-value{ color:var(--primary-color); font-weight:700; min-width:2rem; text-align:right; }

    button.primary{
      background:var(--button-bg); color:#fff; padding:.9rem 2.5rem; border:none; border-radius:8px; font-size:1.1rem; cursor:pointer;
      margin:2rem auto 0; display:block; transition:background .2s ease, transform .2s ease;
    }
    button.primary:hover{ background:var(--button-hover); transform:translateY(-2px); }

    .output{
      background:#fff; padding:2rem; border-radius:12px; border-left:5px solid var(--secondary-color); margin-top:2rem; display:none;
      animation:slideIn .5s ease;
    }
    @keyframes slideIn{ from{ transform:translateY(20px); opacity:0; } to{ transform:translateY(0); opacity:1; } }
    .output h2{ color:var(--primary-color); margin:0 0 1rem 0; font-size:1.6rem; }
    .output-section{ margin-bottom:1.25rem; }
    .output-section h3{ color:var(--secondary-color); font-size:1.2rem; margin:.25rem 0 .5rem; }
    .output-section p{ margin:.4rem 0; }

    .suggestions{ background:#fef3c7; padding:1rem; border-radius:8px; margin-top:1rem; }
    .suggestions ul{ list-style:none; padding:0; margin:0; }
    .suggestions li{ display:flex; gap:.5rem; margin:.5rem 0; }
    .suggestions li::before{ content:"✨"; }

    /* Footer */
    footer{ background:var(--primary-color); color:#fff; text-align:center; padding:1.5rem 1rem; }
    footer a{ color:var(--link-hover); text-decoration:underline; }
    .footer-note{ font-size:.875rem; margin-top:.5rem; }

    /* Responsive */
    @media (min-width:768px){ .md\:text-6xl{ font-size:3.75rem; } }
    @media (max-width:768px){
      .menu-toggle{ display:inline-block; }
      #primary-nav{
        position:absolute; left:0; top:100%; width:100%;
        background:linear-gradient(to right,var(--primary-color),var(--secondary-color));
        flex-direction:column; gap:0; padding:.75rem 1rem; display:none;
        box-shadow:0 4px 8px rgba(0,0,0,.2);
      }
      #primary-nav.active{ display:flex; }
      #primary-nav li + li{ margin-top:.25rem; }
      nav .container{ flex-wrap:wrap; gap:.5rem; }
      .lang-toggle{ font-size:1rem; padding:.4rem .8rem; }

      .py-20{ padding:1.5rem 0; } .py-16{ padding:1.25rem 0; }
      .text-5xl{ font-size:1.75rem; } .md\:text-6xl{ font-size:2rem; }
      .text-3xl{ font-size:1.5rem; } .text-2xl{ font-size:1.25rem; } .text-xl,.text-lg{ font-size:1rem; }
    }
    @media (max-width:480px){
      .logo-img{ width:24px; height:24px; }
      .logo-link{ font-size:1rem; }
      .lang-toggle{ font-size:.95rem; }
    }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){ *{ animation:none !important; transition:none !important; } }
  </style>
</head>
<body>
  <nav role="navigation">
    <div class="container">
      <a href="index.html" class="logo-link" aria-label="Перейти на головну сторінку / Go to homepage">
        <img src="images/favicon-v2.png" alt="Логотип Я є / I Am logo" class="logo-img" width="32" height="32" />
        <span class="logo-text">
          <span class="lang-section lang-uk active" lang="uk">Я є</span>
          <span class="lang-section lang-en" lang="en">I Am</span>
        </span>
      </a>

      <div style="display:flex; align-items:center; gap:.5rem; margin-left:auto;">
        <button class="menu-toggle" aria-label="Переключити меню навігації / Toggle navigation menu" aria-expanded="false" aria-controls="primary-nav">☰</button>
        <button type="button" class="lang-toggle" aria-label="Переключити мову / Toggle language">UA / EN</button>
      </div>

      <ul id="primary-nav">
        <li><a href="index.html"><span class="lang-section lang-uk active" lang="uk">Головна</span><span class="lang-section lang-en" lang="en">Home</span></a></li>
        <li><a href="archetypes.html"><span class="lang-section lang-uk active" lang="uk">Про архетипи</span><span class="lang-section lang-en" lang="en">About Archetypes</span></a></li>
        <li><a href="about.html"><span class="lang-section lang-uk active" lang="uk">Про мене</span><span class="lang-section lang-en" lang="en">About Me</span></a></li>
        <li><a href="tools.html"><span class="lang-section lang-uk active" lang="uk">Інструменти</span><span class="lang-section lang-en" lang="en">Tools</span></a></li>
        <li><a href="mind-exploration.html"><span class="lang-section lang-uk active" lang="uk">Мисленне Дослідження</span><span class="lang-section lang-en" lang="en">Mental Exploration</span></a></li>
        <li><a href="unravel-anxiety.html"><span class="lang-section lang-uk active" lang="uk">Розплутування Тривоги</span><span class="lang-section lang-en" lang="en">Anxiety Knot Unraveler</span></a></li>
        <li><a href="blog.html"><span class="lang-section lang-uk active" lang="uk">Як жити далі?</span><span class="lang-section lang-en" lang="en">How to Live On?</span></a></li>
        <li><a href="humor.html"><span class="lang-section lang-uk active" lang="uk">Гумор</span><span class="lang-section lang-en" lang="en">Humor</span></a></li>
        <li><a href="price.html"><span class="lang-section lang-uk active" lang="uk">Прайс</span><span class="lang-section lang-en" lang="en">Pricing</span></a></li>
        <li><a href="contact.html"><span class="lang-section lang-uk active" lang="uk">Контакти</span><span class="lang-section lang-en" lang="en">Contact</span></a></li>
      </ul>
    </div>
  </nav>

  <main class="page-wrap">
    <section class="bg-gradient-to-r py-20 text-center hero">
      <div class="container">
        <h1 class="text-5xl md:text-6xl font-bold font-lora mb-4">
          <span class="lang-section lang-uk active" lang="uk">Розплутувач тривожного клубка</span>
          <span class="lang-section lang-en" lang="en">Anxiety Knot Unraveler</span>
        </h1>
        <p class="text-lg subtitle" style="max-width:60ch; margin:0 auto;">
          <span class="lang-section lang-uk active" lang="uk">Твій провідник у світ тривожних думок. Визнач, що тебе турбує, з’ясуй причини та отримай поради, як розплутати цей клубок.</span>
          <span class="lang-section lang-en" lang="en">Your guide through anxious thoughts. Identify what’s troubling you, uncover the reasons, and get tips to unravel this knot.</span>
        </p>
      </div>
    </section>

    <section class="py-16 bg-gray-50">
      <div class="container" style="max-width:800px;">
        <form id="anxietyForm" novalidate>
          <div class="stage">
            <h2 class="text-2xl font-semibold">
              <span class="lang-section lang-uk active" lang="uk">1. Що за клубок?</span>
              <span class="lang-section lang-en" lang="en">1. What’s the Knot?</span>
            </h2>
            <p>
              <span class="lang-section lang-uk active" lang="uk">Опиши думку, яка тебе турбує. Напр.: «Я можу провалитися» або «Мене не зрозуміють».</span>
              <span class="lang-section lang-en" lang="en">Describe the thought that’s troubling you. E.g., “I might fail” or “People won’t understand me.”</span>
            </p>
            <label for="thought">
              <span class="lang-section lang-uk active" lang="uk">Твоя тривожна думка:</span>
              <span class="lang-section lang-en" lang="en">Your anxious thought:</span>
            </label>
            <input type="text" id="thought" name="thought" placeholder="Що тебе турбує? / What’s troubling you?" required>
          </div>

          <div class="stage">
            <h2 class="text-2xl font-semibold">
              <span class="lang-section lang-uk active" lang="uk">2. Наскільки туго затягнуто?</span>
              <span class="lang-section lang-en" lang="en">2. How Tight Is It?</span>
            </h2>
            <p>
              <span class="lang-section lang-uk active" lang="uk">Оціни інтенсивність тривоги (0 — не турбує, 10 — нестерпно).</span>
              <span class="lang-section lang-en" lang="en">Rate anxiety intensity (0 — not troubling, 10 — unbearable).</span>
            </p>
            <div class="slider-container">
              <input type="range" id="intensity" name="intensity" min="0" max="10" value="0" aria-labelledby="intensityValue">
              <span class="slider-value" id="intensityValue">0</span>
            </div>
          </div>

          <div class="stage">
            <h2 class="text-2xl font-semibold">
              <span class="lang-section lang-uk active" lang="uk">3. Де почався цей клубок?</span>
              <span class="lang-section lang-en" lang="en">3. Where Did This Knot Start?</span>
            </h2>
            <p>
              <span class="lang-section lang-uk active" lang="uk">Що могло запустити цю думку? Подія, розмова, спогад чи відчуття.</span>
              <span class="lang-section lang-en" lang="en">What might have triggered this thought? Event, conversation, memory, or feeling.</span>
            </p>
            <label for="trigger">
              <span class="lang-section lang-uk active" lang="uk">Тригер думки:</span>
              <span class="lang-section lang-en" lang="en">Thought trigger:</span>
            </label>
            <textarea id="trigger" name="trigger" placeholder="Що могло спричинити? / What might have caused it?"></textarea>
          </div>

          <div class="stage">
            <h2 class="text-2xl font-semibold">
              <span class="lang-section lang-uk active" lang="uk">4. Як це відчувається?</span>
              <span class="lang-section lang-en" lang="en">4. How Does It Feel?</span>
            </h2>
            <p>
              <span class="lang-section lang-uk active" lang="uk">Що відбувається в тілі? Напруга, важкість, тепло, холод?</span>
              <span class="lang-section lang-en" lang="en">What happens in the body? Tension, heaviness, warmth, cold?</span>
            </p>
            <label for="feelings">
              <span class="lang-section lang-uk active" lang="uk">Фізичні відчуття:</span>
              <span class="lang-section lang-en" lang="en">Physical sensations:</span>
            </label>
            <textarea id="feelings" name="feelings" placeholder="Опиши відчуття / Describe sensations"></textarea>
          </div>

          <div class="stage">
            <h2 class="text-2xl font-semibold">
              <span class="lang-section lang-uk active" lang="uk">5. Як це змінює твій шлях?</span>
              <span class="lang-section lang-en" lang="en">5. How Does It Change Your Path?</span>
            </h2>
            <p>
              <span class="lang-section lang-uk active" lang="uk">Як думка впливає на рішення чи дії?</span>
              <span class="lang-section lang-en" lang="en">How does the thought affect decisions or actions?</span>
            </p>
            <label for="behavior">
              <span class="lang-section lang-uk active" lang="uk">Зміни в поведінці:</span>
              <span class="lang-section lang-en" lang="en">Changes in behavior:</span>
            </label>
            <textarea id="behavior" name="behavior" placeholder="Що робиш інакше / What changes?"></textarea>
          </div>

          <div class="stage">
            <h2 class="text-2xl font-semibold">
              <span class="lang-section lang-uk active" lang="uk">6. Чи міцна ця нитка?</span>
              <span class="lang-section lang-en" lang="en">6. Is This Thread Strong?</span>
            </h2>
            <p>
              <span class="lang-section lang-uk active" lang="uk">Чи завжди вона правдива? Є винятки?</span>
              <span class="lang-section lang-en" lang="en">Is it always true? Any exceptions?</span>
            </p>
            <label for="reality">
              <span class="lang-section lang-uk active" lang="uk">Реальність думки:</span>
              <span class="lang-section lang-en" lang="en">Reality of the thought:</span>
            </label>
            <textarea id="reality" name="reality" placeholder="Підстави вірити / Reasons to believe"></textarea>
          </div>

          <div class="stage">
            <h2 class="text-2xl font-semibold">
              <span class="lang-section lang-uk active" lang="uk">7. Що живить цю тривогу?</span>
              <span class="lang-section lang-en" lang="en">7. What Fuels This Anxiety?</span>
            </h2>
            <p>
              <span class="lang-section lang-uk active" lang="uk">Які емоції чи потреби за думкою?</span>
              <span class="lang-section lang-en" lang="en">Which emotions or needs are behind it?</span>
            </p>
            <label for="emotions">
              <span class="lang-section lang-uk active" lang="uk">Основні емоції/потреби:</span>
              <span class="lang-section lang-en" lang="en">Core emotions/needs:</span>
            </label>
            <textarea id="emotions" name="emotions" placeholder="Страх, безпека, визнання… / Fear, safety, recognition…"></textarea>
          </div>

          <button type="button" class="primary" id="unravelBtn">
            <span class="lang-section lang-uk active" lang="uk">Розплутати клубок</span>
            <span class="lang-section lang-en" lang="en">Unravel the Knot</span>
          </button>
        </form>

        <div class="output" id="output"></div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container">
      <p>
        <span class="lang-section lang-uk active" lang="uk">© 2025 Я є. Усі права захищено.</span>
        <span class="lang-section lang-en" lang="en">© 2025 I Am. All rights reserved.</span>
      </p>
      <p class="footer-note">
        <span class="lang-section lang-uk active" lang="uk">Створено, щоб допомогти розібратися з тривогами. Ти сильніший, ніж твій клубок!</span>
        <span class="lang-section lang-en" lang="en">Created to help you tackle your anxieties. You’re stronger than your knot!</span>
      </p>
    </div>
  </footer>

  <script>
    (function(){
      const $  = (s,r=document)=>r.querySelector(s);
      const $$ = (s,r=document)=>Array.from(r.querySelectorAll(s));

      const SELECTORS = {
        nav:'#primary-nav',
        menuBtn:'.menu-toggle',
        langBtn:'.lang-toggle',
        langSections:'.lang-section',
        range:'#intensity',
        rangeValue:'#intensityValue',
        output:'#output',
        unravelBtn:'#unravelBtn'
      };

      const TITLES = {
        uk:'Розплутувач тривожного клубка',
        en:'Anxiety Knot Unraveler'
      };
      const DESCS = {
        uk:'Інструмент для розплутування тривожних думок. Визнач, що тебе турбує, з’ясуй причини та отримай поради.',
        en:'A tool for unraveling anxious thoughts. Identify what’s troubling you, uncover the reasons, and get tips.'
      };

      function updateHead(lang){
        document.title = TITLES[lang];
        const ogTitle = document.querySelector('meta[property="og:title"]');
        const ogDesc  = document.querySelector('meta[property="og:description"]');
        const desc    = document.querySelector('meta[name="description"]');
        if(ogTitle) ogTitle.content = TITLES[lang];
        if(ogDesc)  ogDesc.content  = DESCS[lang];
        if(desc)    desc.content    = DESCS[lang];
      }

      function applyLang(lang){
        $$('.lang-section').forEach(el=>el.classList.remove('active'));
        $$(`.lang-${lang}`).forEach(el=>el.classList.add('active'));
        document.documentElement.lang = lang;
        const btn = $(SELECTORS.langBtn);
        if(btn) btn.textContent = (lang === 'uk') ? 'UA / EN' : 'EN / UA';
        updateHead(lang);
        try{ localStorage.setItem('lang',lang); }catch(e){}
      }

      function initLang(){
        let saved = 'uk';
        try{ saved = localStorage.getItem('lang') || 'uk'; }catch(e){}
        applyLang(saved);
        const btn = $(SELECTORS.langBtn);
        if(btn){
          btn.addEventListener('click', ()=>{
            const now = document.documentElement.lang || 'uk';
            applyLang(now === 'uk' ? 'en' : 'uk');
          });
        }
      }

      function initMenu(){
        const nav = $(SELECTORS.nav);
        const btn = $(SELECTORS.menuBtn);
        if(!nav || !btn) return;

        function open(){ nav.classList.add('active'); btn.setAttribute('aria-expanded','true'); btn.textContent = '✕'; document.addEventListener('click', outside, true); document.addEventListener('keydown', esc); }
        function close(){ nav.classList.remove('active'); btn.setAttribute('aria-expanded','false'); btn.textContent = '☰'; document.removeEventListener('click', outside, true); document.removeEventListener('keydown', esc); }
        function outside(e){ if(nav.contains(e.target) || btn.contains(e.target)) return; close(); }
        function esc(e){ if(e.key==='Escape') close(); }

        btn.addEventListener('click', ()=> nav.classList.contains('active') ? close() : open());

        // highlight current page
        const current = window.location.pathname.split('/').pop() || 'index.html';
        nav.querySelectorAll('a').forEach(a=>{
          if(a.getAttribute('href')===current){ a.classList.add('active'); a.setAttribute('aria-current','page'); }
        });
      }

      function initRange(){
        const range = $(SELECTORS.range);
        const out = $(SELECTORS.rangeValue);
        if(!range || !out) return;
        out.textContent = range.value;
        range.addEventListener('input', ()=> out.textContent = range.value);
      }

      function htmlEsc(str){
        return str.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
      }

      function buildOutput(){
        const lang = (document.documentElement.lang === 'en') ? 'en' : 'uk';
        const t = id => htmlEsc(($('#'+id)?.value || '').trim());

        const thought   = t('thought');
        const intensity = parseInt($('#intensity')?.value || '0',10);
        const trigger   = t('trigger')   || (lang==='uk' ? 'Не вказано' : 'Not specified');
        const feelings  = t('feelings')  || (lang==='uk' ? 'Не вказано' : 'Not specified');
        const behavior  = t('behavior')  || (lang==='uk' ? 'Не вказано' : 'Not specified');
        const reality   = t('reality')   || (lang==='uk' ? 'Не вказано' : 'Not specified');
        const emotions  = t('emotions')  || (lang==='uk' ? 'Не вказано' : 'Not specified');

        if(!thought){
          alert(lang==='uk' ? 'Будь ласка, вкажи свою тривожну думку!' : 'Please enter your anxious thought!');
          $('#thought')?.focus();
          return;
        }

        let out = `
          <h2>
            <span class="lang-section lang-uk${lang==='uk'?' active':''}">Твій розплутаний клубок</span>
            <span class="lang-section lang-en${lang==='en'?' active':''}">Your Unraveled Knot</span>
          </h2>
          <div class="output-section">
            <p><strong><span class="lang-section lang-uk${lang==='uk'?' active':''}">Твоя думка:</span><span class="lang-section lang-en${lang==='en'?' active':''}">Your thought:</span></strong> ${thought}</p>
            <p><strong><span class="lang-section lang-uk${lang==='uk'?' active':''}">Інтенсивність тривоги:</span><span class="lang-section lang-en${lang==='en'?' active':''}">Anxiety intensity:</span></strong> ${intensity}/10</p>
            <p><strong><span class="lang-section lang-uk${lang==='uk'?' active':''}">Тригер:</span><span class="lang-section lang-en${lang==='en'?' active':''}">Trigger:</span></strong> ${trigger}</p>
            <p><strong><span class="lang-section lang-uk${lang==='uk'?' active':''}">Фізичні відчуття:</span><span class="lang-section lang-en${lang==='en'?' active':''}">Physical sensations:</span></strong> ${feelings}</p>
            <p><strong><span class="lang-section lang-uk${lang==='uk'?' active':''}">Зміни в поведінці:</span><span class="lang-section lang-en${lang==='en'?' active':''}">Changes in behavior:</span></strong> ${behavior}</p>
            <p><strong><span class="lang-section lang-uk${lang==='uk'?' active':''}">Реальність думки:</span><span class="lang-section lang-en${lang==='en'?' active':''}">Reality of the thought:</span></strong> ${reality}</p>
            <p><strong><span class="lang-section lang-uk${lang==='uk'?' active':''}">Емоції та потреби:</span><span class="lang-section lang-en${lang==='en'?' active':''}">Emotions and needs:</span></strong> ${emotions}</p>
          </div>
        `;

        // Suggestions logic
        function includesAny(s, arr){ s = s.toLowerCase(); return arr.some(x=>s.includes(x)); }

        let sugg = `
          <div class="suggestions">
            <h3><span class="lang-section lang-uk${lang==='uk'?' active':''}">Практичні кроки</span><span class="lang-section lang-en${lang==='en'?' active':''}">Practical Steps</span></h3>
            <ul>
        `;

        // by intensity
        if(intensity <= 3){
          sugg += `<li><span class="lang-section lang-uk${lang==='uk'?' active':''}">Легка тривога: занотуй думку й повернись до неї завтра — чи така ж важлива?</span><span class="lang-section lang-en${lang==='en'?' active':''}">Mild anxiety: note the thought and revisit tomorrow — is it still as important?</span></li>`;
        } else if(intensity <= 7){
          sugg += `<li><span class="lang-section lang-uk${lang==='uk'?' active':''}">Відчутна тривога: запиши 3 дії на зараз (вода, улюблена пісня, 10 глибоких вдихів).</span><span class="lang-section lang-en${lang==='en'?' active':''}">Noticeable anxiety: write 3 actions for now (water, favorite song, 10 deep breaths).</span></li>`;
        } else {
          sugg += `<li><span class="lang-section lang-uk${lang==='uk'?' active':''}">Сильна тривога: випиши думку великими літерами, порви аркуш — ритуал відпускання.</span><span class="lang-section lang-en${lang==='en'?' active':''}">Strong anxiety: write it in big letters, tear the page — a letting-go ritual.</span></li>`;
        }

        // by trigger
        if(includesAny(trigger, ['подія','розмова','спогад','event','conversation','memory'])){
          sugg += `<li><span class="lang-section lang-uk${lang==='uk'?' active':''}">Є конкретна ситуація: напиши міні-історію (3–5 речень) з позитивним фіналом.</span><span class="lang-section lang-en${lang==='en'?' active':''}">Specific situation: write a 3–5 sentence mini-story with a positive ending.</span></li>`;
        } else {
          sugg += `<li><span class="lang-section lang-uk${lang==='uk'?' active':''}">Тригер неясний: 2–3 дні фіксуй час і контекст появи думки.</span><span class="lang-section lang-en${lang==='en'?' active':''}">Trigger unclear: for 2–3 days log the time and context when it appears.</span></li>`;
        }

        // by feelings
        if(includesAny(feelings, ['напруга','важкість','серцебиття','tension','heaviness','heart'])){
          sugg += `<li><span class="lang-section lang-uk${lang==='uk'?' active':''}">Тіло напружене: стисни кулаки 5 сек — розслаб — потряси руками (3 рази).</span><span class="lang-section lang-en${lang==='en'?' active':''}">Body tense: clench fists 5s — release — shake hands (3 times).</span></li>`;
        } else {
          sugg += `<li><span class="lang-section lang-uk${lang==='uk'?' active':''}">Тіло спокійне: уяви думку як хмаринку й «задуй» її тричі.</span><span class="lang-section lang-en${lang==='en'?' active':''}">Body calm: imagine the thought as a cloud and blow it away three times.</span></li>`;
        }

        // by behavior
        if(includesAny(behavior, ['уникаю','зупиняю','avoid','stop'])){
          sugg += `<li><span class="lang-section lang-uk${lang==='uk'?' active':''}">Вибери одну «лякалку», розбий на 3 крихітні кроки, зроби перший сьогодні.</span><span class="lang-section lang-en${lang==='en'?' active':''}">Choose one scary action, split into 3 tiny steps, take the first today.</span></li>`;
        } else {
          sugg += `<li><span class="lang-section lang-uk${lang==='uk'?' active':''}">Уяви себе героєм, що не боїться цієї думки. Заплануй 1 крок на завтра.</span><span class="lang-section lang-en${lang==='en'?' active':''}">Imagine being a hero unfazed by the thought. Plan 1 step for tomorrow.</span></li>`;
        }

        // by reality
        if(includesAny(reality, ['не працює','спростов','doesn’t hold','contradict'])){
          sugg += `<li><span class="lang-section lang-uk${lang==='uk'?' active':''}">Запиши 3 випадки, де думка не спрацювала; перечитуй, коли повертається.</span><span class="lang-section lang-en${lang==='en'?' active':''}">List 3 cases it failed; reread when it returns.</span></li>`;
        } else {
          sugg += `<li><span class="lang-section lang-uk${lang==='uk'?' active':''}">Склади протилежну думку й повторюй 5 разів щодня перед дзеркалом.</span><span class="lang-section lang-en${lang==='en'?' active':''}">Craft an opposite thought and repeat 5 times daily in front of a mirror.</span></li>`;
        }

        // by emotions
        if(includesAny(emotions, ['страх','невпевненість','fear','insecurity'])){
          sugg += `<li><span class="lang-section lang-uk${lang==='uk'?' active':''}">Лист собі: 5 речень, чому ти ок. Читай при сумнівах.</span><span class="lang-section lang-en${lang==='en'?' active':''}">Write 5 lines to yourself about why you’re ok. Read when doubting.</span></li>`;
        } else if(includesAny(emotions, ['безпека','визнання','safety','recognition'])){
          sugg += `<li><span class="lang-section lang-uk${lang==='uk'?' active':''}">Дай собі турботу сьогодні (улюблена страва/фільм) і скажи: «Я того варта».</span><span class="lang-section lang-en${lang==='en'?' active':''}">Give yourself care today (meal/movie) and say: “I’m worth it.”</span></li>`;
        } else {
          sugg += `<li><span class="lang-section lang-uk${lang==='uk'?' active':''}">Склади топ-5 речей, що тішать, і роби щодня хоча б одну.</span><span class="lang-section lang-en${lang==='en'?' active':''}">Make a top-5 of things that lift you up and do at least one daily.</span></li>`;
        }

        sugg += `<li><span class="lang-section lang-uk${lang==='uk'?' active':''}">Веди «щоденник думок»: щовечора одна тривожна думка + один позитив дня.</span><span class="lang-section lang-en${lang==='en'?' active':''}">Keep a thought journal: each evening one anxious thought + one positive of the day.</span></li>`;
        sugg += `</ul></div>`;

        out += sugg;

        const box = $(SELECTORS.output);
        box.innerHTML = out;
        box.style.display = 'block';
        box.scrollIntoView({behavior:'smooth'});
      }

      function initForm(){
        $(SELECTORS.unravelBtn)?.addEventListener('click', buildOutput);
      }

      document.addEventListener('DOMContentLoaded', ()=>{
        // initial language from storage
        initLang();
        // nav + highlight
        initMenu();
        // range label
        initRange();
      });
    })();
  </script>
</body>
</html>
